{
  "name": "Hotels-Agent-CRISTI",
  "nodes": [
    {
      "parameters": {
        "toolDescription": "Scrape Google maps to get reviews",
        "method": "POST",
        "url": "https://api.apify.com/v2/acts/compass~crawler-google-places/run-sync-get-dataset-items?token=APIFY_API_KEY_REDACTED",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "maxItems",
              "value": "15"
            },
            {
              "name": "limit",
              "value": "15"
            },
            {
              "name": "maxTotalChargeUsd",
              "value": "={{ Number(0.15) }}"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"locationQuery\": \"{{ $fromAI('locationQuery', `Define location using free text. Simpler formats work best; e.g., use City + Country`, 'string', 'Sibiu') }}\",\n    \"maxCrawledPlacesPerSearch\": {{ $fromAI('maxCrawledPlacesPerSearch', `Maximum number of places to crawl per search`, 'number', 10) }},\n    \"language\": \"{{ $fromAI('language', `The language to search in (en, ro, us)`, 'string', 'ro') }}\",\n    \"maxReviews\": {{ $fromAI('maxReviews', `How many reviews should we want to have?`, 'number', 10) }},\n    \"reviewsSort\": \"newest\",\n    \"reviewsOrigin\": \"google\",\n    \"scrapeReviewsPersonalData\": false,\n    \"searchStringsArray\": [\"hotels\"],\n    \"city\": \"{{ $fromAI('city', 'The specific city name for location-based search', 'string') }}\",\n    \"scrapeImageAuthors\": false,\n    \"maxImages\": 5\n}",
        "options": {},
        "optimizeResponse": true,
        "fieldsToInclude": "selected",
        "fields": "=hotelStars,hotelDescription,checkInDate,checkOutDate,similarHotelsNearby,hotelAds,placeId,totalScore,reviewsCount,reviewsDistribution,reviews,searchString,address,title,city,searchPageUrl"
      },
      "type": "n8n-nodes-base.httpRequestTool",
      "typeVersion": 4.2,
      "position": [
        2176,
        -336
      ],
      "id": "686c1800-f5d0-41f3-9dfa-8fd94e843fad",
      "name": "Scrape Google Maps",
      "retryOnFail": true,
      "alwaysOutputData": false,
      "disabled": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1216,
        -128
      ],
      "id": "836353e7-45cf-4098-a189-5f41cc429dbc",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "6crYZOqBsqTBxATq",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "tableName": "hotels_agent",
        "contextWindowLength": 20
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        1360,
        -128
      ],
      "id": "46648272-8711-492a-800b-f3152faf4140",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "FPy2djSGyWu7XCgP",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "1cedc1f8-0343-4fd7-ae02-c94ebfcacc69",
              "name": "chatInput",
              "value": "={{ $json.body.chatInput }}",
              "type": "string"
            },
            {
              "id": "fbff52a0-dbd2-47a5-b933-27ead60f90fa",
              "name": "sessionId",
              "value": "={{ $json.body.sessionId }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1184,
        -528
      ],
      "id": "28774ac5-cf39-4376-998e-21a7145a7aab",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "042d2591-94ed-43a9-a5e5-0860412c08e5",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        976,
        -528
      ],
      "id": "b10ffbe9-3177-4033-bd56-2bd3080d0da6",
      "name": "Vola Webhook",
      "webhookId": "042d2591-94ed-43a9-a5e5-0860412c08e5"
    },
    {
      "parameters": {
        "content": "## Vola\nWebhook",
        "height": 240,
        "width": 1392,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        928,
        -624
      ],
      "typeVersion": 1,
      "id": "d81f923b-531f-453f-9b81-2fe1cb608b92",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "toolDescription": "Get Accomodation Reviews for Airbnb Platform",
        "method": "POST",
        "url": "https://api.apify.com/v2/acts/tri_angle~airbnb-reviews-scraper/run-sync-get-dataset-items?token=APIFY_API_KEY_REDACTED",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "maxItems",
              "value": "15"
            },
            {
              "name": "limit",
              "value": "15"
            },
            {
              "name": "maxTotalChargeUsd",
              "value": "={{ Number(0.15) }}"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "locale",
              "value": "ro-RO"
            },
            {
              "name": "startUrls",
              "value": "={{ $fromAI('startUrls', 'Array of cleaned hotel URLs from booking scraper results for further processing. This function should extract hotel URLs from the previously scraped Booking.com data and prepare them for additional scraping tools. Process each property object by: 1) Extract the \"url\" field from each hotel/property in the booking results, 2) Clean the URLs by removing all query parameters (strip everything after and including the \"?\" character to get base URLs), 3) Format as an array of objects where each object contains both \"url\" and \"method\" properties, 4) Set method to \"GET\" for all URLs. Expected output format: [{\"url\": \"https://example-hotel-url.com\", \"method\": \"GET\"}, {\"url\": \"https://another-hotel-url.com\", \"method\": \"GET\"}]. This tool should ONLY be called AFTER successfully receiving and processing results from the main Booking.com scraper tool, as it depends on that data to generate the URLs for subsequent processing steps.', 'json') }}"
            }
          ]
        },
        "options": {},
        "optimizeResponse": true,
        "fieldsToInclude": "selected",
        "fields": "localizedText,startUrl,rating,text,id,localizedReview"
      },
      "type": "n8n-nodes-base.httpRequestTool",
      "typeVersion": 4.2,
      "position": [
        1552,
        48
      ],
      "id": "418d49e6-2fe8-4cf7-a255-71f318003bfc",
      "name": "Reviews Airbnb",
      "retryOnFail": true,
      "alwaysOutputData": false,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "toolDescription": "Get Accomodation Reviews for Booking.com Platform",
        "method": "POST",
        "url": "https://api.apify.com/v2/acts/voyager~booking-reviews-scraper/run-sync-get-dataset-items?token=APIFY_API_KEY_REDACTED",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "maxItems",
              "value": "15"
            },
            {
              "name": "limit",
              "value": "15"
            },
            {
              "name": "maxTotalChargeUsd",
              "value": "={{ Number(0.15) }}"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "cutoffDate",
              "value": "200 days"
            },
            {
              "name": "maxReviewsPerHotel",
              "value": "={{ Number(50) }}"
            },
            {
              "name": "sortReviewsBy",
              "value": "f_relevance"
            },
            {
              "name": "startUrls",
              "value": "={{ $fromAI('startUrls', 'Array of cleaned hotel URLs from booking scraper results. Extract the url field from each property, STRIP query parameters (remove ? and everything after), then format as [{\"url\": \"clean_hotel_url_1\"}, {\"url\": \"clean_hotel_url_2\"}]. This tool should only be called AFTER receiving results from the main Booking.com scraper.', 'json') }}"
            }
          ]
        },
        "options": {},
        "optimizeResponse": true,
        "fieldsToInclude": "except",
        "fields": "userAvatar,id,stayRoomId,hotelId,reviewsScoreFilter,reviewPage,startUrl,checkInDate,checkOutDate"
      },
      "type": "n8n-nodes-base.httpRequestTool",
      "typeVersion": 4.2,
      "position": [
        1728,
        48
      ],
      "id": "9f6d9fc3-6554-46c4-8e03-0af0b16ce577",
      "name": "Reviews Booking",
      "retryOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "content": "## Tools\nBusinessLogic",
        "height": 388,
        "width": 1212,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1104,
        16
      ],
      "typeVersion": 1,
      "id": "9789f9f3-6c8a-4dd8-ab36-b6a65b80be1d",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "## Agent\nBusinessLogic",
        "height": 400,
        "width": 1212,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1104,
        -384
      ],
      "typeVersion": 1,
      "id": "71d95a78-0aaa-4aed-854f-6d8defd5e8bf",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "## Chat \n",
        "height": 788,
        "width": 180
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        928,
        -384
      ],
      "typeVersion": 1,
      "id": "73a7b2cf-20df-432d-9003-777a18f05d15",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.3,
      "position": [
        1952,
        -544
      ],
      "id": "dfc9f6a0-1556-467d-9121-4fee45a045fc",
      "name": "Respond to Webhook",
      "retryOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "toolDescription": "Scrape Booking to get listings.",
        "method": "POST",
        "url": "https://api.apify.com/v2/acts/voyager~booking-scraper/run-sync-get-dataset-items?token=APIFY_API_KEY_REDACTED",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "maxItems",
              "value": "15"
            },
            {
              "name": "limit",
              "value": "15"
            },
            {
              "name": "maxTotalChargeUsd",
              "value": "={{ Number(0.15) }}"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "minMaxPrice",
              "value": "={{ $fromAI('price_range', `The price range acceptable for the user formated as min-max, by default is 0-999999`, 'string') }}"
            },
            {
              "name": "checkIn",
              "value": "={{ $fromAI('check_in_date', `Check in date as ISO date only`, 'string') }}"
            },
            {
              "name": "checkOut",
              "value": "={{ $fromAI('check_out_date', `Check out date as ISO date only`, 'string') }}"
            },
            {
              "name": "search",
              "value": "={{ $fromAI('Destination', `The destination the user wants to visit`, 'string') }}"
            },
            {
              "name": "flexWindow",
              "value": "={{ $fromAI('flexibility_window', `How many days plus or minus the check-in or check-out date the client is ok with`, 'string') }}"
            },
            {
              "name": "adults",
              "value": "={{ $fromAI('adults', `Number of adults for the trip`, 'number') }}"
            },
            {
              "name": "children",
              "value": "={{ $fromAI('children', `Number of children for the trip`, 'number') }}"
            },
            {
              "name": "currency",
              "value": "={{ $fromAI('currency', `Currency in which to display results, usually RON, EUR or USD`, 'string') }}"
            },
            {
              "name": "rooms",
              "value": "={{ $fromAI('rooms', `Number of rooms needed by the client`, 'number') }}"
            },
            {
              "name": "language",
              "value": "ro"
            },
            {
              "name": "propertyType",
              "value": "={{ $fromAI('propertyType', 'One of the following: \"Hotels\", \"Apartments\", \"Hostels\", \"Guest Houses\", \"Homestays\", \"Bed an breakfasts\", \"Holiday homes\", \"Boats\", \"Villas\", \"Motels\", \"Resorts\", \"Holiday parks\", \"Campsites\", \"Luxury tents\" or \"none\"', 'string') }}"
            }
          ]
        },
        "options": {},
        "optimizeResponse": true,
        "fieldsToInclude": "except",
        "fields": "order,licenseInfo,hostInfo,traderInfo,breadcrumbs,timeOfScrapeISO,hotelId"
      },
      "type": "n8n-nodes-base.httpRequestTool",
      "typeVersion": 4.2,
      "position": [
        1904,
        48
      ],
      "id": "3d10ff15-6d94-43b2-b4d0-7d669853883b",
      "name": "Scrape Booking",
      "retryOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "toolDescription": "Scrape AirBnb to get available listings.",
        "method": "POST",
        "url": "https://api.apify.com/v2/acts/tri_angle~airbnb-scraper/run-sync-get-dataset-items?token=APIFY_API_KEY_REDACTED",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "maxItems",
              "value": "15"
            },
            {
              "name": "limit",
              "value": "15"
            },
            {
              "name": "maxTotalChargeUsd",
              "value": "={{ Number(0.15) }}"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "adults",
              "value": "={{ $fromAI('adults', 'Number of adults on the trip', 'number') }}"
            },
            {
              "name": "checkIn",
              "value": "={{ $fromAI('check_in_date', 'Check-in date as ISO date only', 'string') }}"
            },
            {
              "name": "checkOut",
              "value": "={{ $fromAI('check_out_date', 'Check-out date as ISO date only', 'string') }}"
            },
            {
              "name": "children",
              "value": "={{ $fromAI('children', 'Number of children on the trip', 'number') }}"
            },
            {
              "name": "currency",
              "value": "={{ $fromAI('currency', `Currency in which to display results, usually RON, EUR or USD`, 'string') }}"
            },
            {
              "name": "infants",
              "value": "={{ $fromAI('infants', 'Number of infants on the trip', 'number') }}"
            },
            {
              "name": "locale",
              "value": "ro-RO"
            },
            {
              "name": "locationQueries",
              "value": "={{ [$fromAI('destination', `The destination the user wants to visit`, 'string')] }}"
            },
            {
              "name": "minBathrooms",
              "value": "={{ $fromAI('min_bathrooms', 'Minimum number of bathrooms at the stay', 'number') }}"
            },
            {
              "name": "minBedrooms",
              "value": "={{ $fromAI('min_bedrooms', 'Minimum number of bedrooms at the stay', 'number') }}"
            },
            {
              "name": "minBeds",
              "value": "={{ $fromAI('min_beds', 'Minimum number of beds at the stay', 'number') }}"
            },
            {
              "name": "pets",
              "value": "={{ $fromAI('pets', 'Number of pets on the trip', 'number') }}"
            },
            {
              "name": "priceMax",
              "value": "={{ $fromAI('price_max', 'Maximum price per night on the trip', 'number') }}"
            },
            {
              "name": "priceMin",
              "value": "={{ $fromAI('price_min', 'Minimum price per night on the trip', 'number') }}"
            }
          ]
        },
        "options": {},
        "optimizeResponse": true,
        "fieldsToInclude": "except",
        "fields": "id,metaDescription,seoTitle,androidLink,iosLink,breadcrumbs,timestamp,language,descriptionOriginalLanguage"
      },
      "type": "n8n-nodes-base.httpRequestTool",
      "typeVersion": 4.2,
      "position": [
        1376,
        48
      ],
      "id": "114a96e9-3c25-45f0-a794-4c3342a2c7b5",
      "name": "Scrape AirBnb",
      "retryOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "public": true,
        "initialMessages": "Bună, sunt Volabot! 👋\nCu ce te pot ajuta azi?",
        "options": {
          "inputPlaceholder": "Vreau să merg într-o vacanță în Maldive, alături de soția mea, între 14 și 28 august...",
          "showWelcomeScreen": true,
          "subtitle": "Trimite-ne un mesaj, iar agentul nostru îți va găsi cele mai bune opțiuni de cazare care să corespundă preferințelor tale 🌴",
          "title": "Descoperă opțiuni de cazare cu Vola!",
          "customCss": ":root {\n  /* Vola Brand Colors */\n  --chat--color-primary: #4169E1;  /* Vola Blue */\n  --chat--color-primary-shade-50: #3B5FD9;\n  --chat--color-primary-shade-100: #3555D1;\n  --chat--color-secondary: #FFB800;  /* Vola Yellow/Orange */\n  --chat--color-secondary-shade-50: #E6A500;\n  --chat--color-white: #ffffff;\n  --chat--color-light: #f8f9fd;\n  --chat--color-light-shade-50: #eef1fb;\n  --chat--color-light-shade-100: #d9dff7;\n  --chat--color-medium: #c8d0e8;\n  --chat--color-dark: #1a2040;\n  --chat--color-disabled: #6b7280;\n  --chat--color-typing: #374151;\n\n  /* Base Layout */\n  --chat--spacing: 1rem;\n  --chat--border-radius: 0.5rem;  /* Slightly more rounded for modern look */\n  --chat--transition-duration: 0.15s;\n\n  /* Window Dimensions */\n  --chat--window--width: 400px;\n  --chat--window--height: 600px;\n  --chat--window--bottom: var(--chat--spacing);\n  --chat--window--right: var(--chat--spacing);\n  --chat--window--z-index: 9999;\n  --chat--window--border: 1px solid var(--chat--color-light-shade-50);\n  --chat--window--border-radius: 1rem;  /* More rounded window */\n  --chat--window--margin-bottom: var(--chat--spacing);\n\n  /* Header Styles - Vola Blue */\n  --chat--header-height: auto;\n  --chat--header--padding: var(--chat--spacing);\n  --chat--header--background: var(--chat--color-primary);\n  --chat--header--color: var(--chat--color-white);\n  --chat--header--border-top: none;\n  --chat--header--border-bottom: none;\n  --chat--header--border-left: none;\n  --chat--header--border-right: none;\n  --chat--heading--font-size: 2em;\n  --chat--subtitle--font-size: inherit;\n  --chat--subtitle--line-height: 1.8;\n\n  /* Message Styles */\n  --chat--message--font-size: 1rem;\n  --chat--message--padding: var(--chat--spacing);\n  --chat--message--border-radius: 1rem;  /* More rounded messages */\n  --chat--message-line-height: 1.5;\n  --chat--message--margin-bottom: calc(var(--chat--spacing) * 1);\n  --chat--message--bot--background: var(--chat--color-white);\n  --chat--message--bot--color: var(--chat--color-dark);\n  --chat--message--bot--border: 1px solid var(--chat--color-light-shade-50);\n  --chat--message--user--background: var(--chat--color-primary);\n  --chat--message--user--color: var(--chat--color-white);\n  --chat--message--user--border: none;\n  --chat--message--pre--background: rgba(65, 105, 225, 0.1);  /* Light blue background for code */\n  --chat--messages-list--padding: var(--chat--spacing);\n\n  /* Toggle Button - Vola Blue with Yellow accent */\n  --chat--toggle--size: 64px;\n  --chat--toggle--width: var(--chat--toggle--size);\n  --chat--toggle--height: var(--chat--toggle--size);\n  --chat--toggle--border-radius: 50%;\n  --chat--toggle--background: var(--chat--color-primary);\n  --chat--toggle--hover--background: var(--chat--color-primary-shade-50);\n  --chat--toggle--active--background: var(--chat--color-primary-shade-100);\n  --chat--toggle--color: var(--chat--color-white);\n\n  /* Button Styles */\n  --chat--button--color: var(--chat--color-white);\n  --chat--button--background: var(--chat--color-primary);\n  --chat--button--padding: calc(var(--chat--spacing) * 1 / 2) var(--chat--spacing);\n  --chat--button--border-radius: 0.5rem;\n  --chat--button--hover--color: var(--chat--color-white);\n  --chat--button--hover--background: var(--chat--color-primary-shade-50);\n  --chat--close--button--color-hover: var(--chat--color-primary);\n\n  /* Send and File Buttons - Yellow accent */\n  --chat--input--send--button--background: var(--chat--color-secondary);\n  --chat--input--send--button--color: var(--chat--color-dark);\n  --chat--input--send--button--background-hover: var(--chat--color-secondary-shade-50);\n  --chat--input--send--button--color-hover: var(--chat--color-dark);\n  --chat--input--file--button--background: var(--chat--color-white);\n  --chat--input--file--button--color: var(--chat--color-primary);\n  --chat--input--file--button--background-hover: var(--chat--color-light);\n  --chat--input--file--button--color-hover: var(--chat--color-primary-shade-50);\n  --chat--files-spacing: 0.25rem;\n\n  /* Body and Footer - Light blue tint */\n  --chat--body--background: var(--chat--color-light);\n  --chat--footer--background: var(--chat--color-light);\n  --chat--footer--color: var(--chat--color-dark);\n}\n\n/* Custom message styling for Vola theme */\n.chat-message {\n  max-width: 50%;\n  box-shadow: 0 2px 8px rgba(65, 105, 225, 0.1);\n  transition: transform 0.2s ease, box-shadow 0.2s ease;\n}\n\n.chat-message:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(65, 105, 225, 0.15);\n}\n\n/* Additional Vola-specific enhancements */\n.chat-header {\n  background: linear-gradient(135deg, var(--chat--color-primary) 0%, var(--chat--color-primary-shade-50) 100%);\n}\n\n.chat-toggle {\n  box-shadow: 0 4px 16px rgba(65, 105, 225, 0.3);\n  transition: all 0.3s ease;\n}\n\n.chat-toggle:hover {\n  box-shadow: 0 6px 20px rgba(65, 105, 225, 0.4);\n  transform: translateY(-2px);\n}",
          "responseMode": "responseNode"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [
        976,
        -320
      ],
      "id": "6439f8a3-8adc-4b78-a90e-f4705813616d",
      "name": "When chat message received",
      "webhookId": "b419f5d3-82dd-41d3-933d-eca656870ab6"
    },
    {
      "parameters": {
        "toolDescription": "=Analyze and curate optimal 3 images per property for maximum visual impact and booking conversion. Pass property data with image arrays and user preferences as JSON.",
        "text": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Prompt__User_Message_', `Send the actual images as a test:`, 'string') }}",
        "options": {
          "systemMessage": "",
          "passthroughBinaryImages": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agentTool",
      "typeVersion": 2.2,
      "position": [
        2048,
        48
      ],
      "id": "36e645cc-8d85-45d6-a4fd-137637b3f140",
      "name": "Image AI AGENT ANALYZER"
    },
    {
      "parameters": {
        "resource": "image",
        "operation": "analyze",
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "text": "Analyze these property images and evaluate each one for: 1) Visual Quality (composition, lighting, clarity, professional appearance) on a 0-4 scale, 2) Content Relevance (unique features, room types, amenities, marketing appeal) on a 0-4 scale, 3) Marketing Value \n  (does this image make someone want to book?). For each image, identify: room type, key features, visual quality score, content score, and any standout elements. Provide detailed analysis to help select the 3 most compelling images for booking conversion.",
        "imageUrls": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('URL_s_', `Extract ALL image URLs from the property's images array and return them as a comma-separated string. The property object contains an images array with URL fields. Extract each URL and join them with commas. Example: 'url1.jpg,url2.jpg,url3.jpg'`, 'string') }}",
        "simplify": false,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGeminiTool",
      "typeVersion": 1,
      "position": [
        2192,
        240
      ],
      "id": "5f84bbfd-f720-43dd-a113-1423b0d4d161",
      "name": "Analyze image in Google Gemini",
      "credentials": {
        "googlePalmApi": {
          "id": "6crYZOqBsqTBxATq",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        2048,
        240
      ],
      "id": "43d49130-57a0-45b1-a232-47013d5b53d0",
      "name": "GEMINI MODEL",
      "credentials": {
        "googlePalmApi": {
          "id": "6crYZOqBsqTBxATq",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "",
          "returnIntermediateSteps": false,
          "passthroughBinaryImages": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        1520,
        -304
      ],
      "id": "26b827f9-16c2-46b5-883f-d49afc5053f2",
      "name": "Main AI AGENT",
      "retryOnFail": true,
      "alwaysOutputData": false,
      "waitBetweenTries": 2500,
      "maxTries": 5,
      "onError": "continueErrorOutput"
    }
  ],
  "pinData": {},
  "connections": {
    "Vola Webhook": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Main AI AGENT",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "Main AI AGENT",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Main AI AGENT",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "Main AI AGENT",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Reviews Airbnb": {
      "ai_tool": [
        [
          {
            "node": "Main AI AGENT",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Reviews Booking": {
      "ai_tool": [
        [
          {
            "node": "Main AI AGENT",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Scrape Booking": {
      "ai_tool": [
        [
          {
            "node": "Main AI AGENT",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Scrape AirBnb": {
      "ai_tool": [
        [
          {
            "node": "Main AI AGENT",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Image AI AGENT ANALYZER": {
      "ai_tool": [
        [
          {
            "node": "Main AI AGENT",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Analyze image in Google Gemini": {
      "ai_tool": [
        [
          {
            "node": "Image AI AGENT ANALYZER",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "GEMINI MODEL": {
      "ai_languageModel": [
        [
          {
            "node": "Image AI AGENT ANALYZER",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Main AI AGENT": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "timezone": "Europe/Bucharest",
    "callerPolicy": "workflowsFromSameOwner"
  },
  "versionId": "7e66994b-f83a-450d-961e-9b54718a7a16",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "70494cb356420efc72c2a7a47e27b7a31b783bdae5a28ee35c1530986f0f1709"
  },
  "id": "y9jenh0MXes2vec3",
  "tags": [
    {
      "createdAt": "2025-08-25T15:36:57.340Z",
      "updatedAt": "2025-08-25T15:36:57.340Z",
      "id": "3l4Lwwau5pfBMZl3",
      "name": "v3"
    },
    {
      "createdAt": "2025-09-02T10:27:32.363Z",
      "updatedAt": "2025-09-02T10:27:32.363Z",
      "id": "2BtkD10KS8583pCr",
      "name": "working"
    }
  ]
}